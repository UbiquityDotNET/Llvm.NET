<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Struct DictionaryBuilder&lt;TKey, TValue&gt; | Ubiquity.NET </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Struct DictionaryBuilder&lt;TKey, TValue&gt; | Ubiquity.NET ">
      
      <meta name="description" content="Simple type to support direct creation of an immutable array via">
      <link rel="icon" href="../../favicon.ico">
      <link rel="stylesheet" href="../../public/docfx.min.css">
      <link rel="stylesheet" href="../../public/main.css">
      <meta name="docfx:navrel" content="../../toc.html">
      <meta name="docfx:tocrel" content="../toc.html">
      
      
      
      
      <meta name="docfx:docurl" content="https://github.com/UbiquityDotNET/Llvm.NET/new/develop/apiSpec/new?filename=Ubiquity_NET_Extensions_DictionaryBuilder_2.md&amp;value=---%0Auid%3A%20Ubiquity.NET.Extensions.DictionaryBuilder%602%0Asummary%3A%20&#39;*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax&#39;%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="ManagedReference">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../../index.html">
            <img id="logo" class="svg" src="../../llvm/DragonSharp48x48.png" alt="">
            
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

        </div>

        <article data-uid="Ubiquity.NET.Extensions.DictionaryBuilder`2">



  <h1 id="Ubiquity_NET_Extensions_DictionaryBuilder_2" data-uid="Ubiquity.NET.Extensions.DictionaryBuilder`2" class="text-break">
Struct DictionaryBuilder&lt;TKey, TValue&gt;  <a class="header-action link-secondary" title="View source" href="https://github.com/UbiquityDotNET/Llvm.NET/blob/v20.1.8-rc.1/src/Ubiquity.NET.Extensions/DictionaryBuilder.cs/#L24"><i class="bi bi-code-slash"></i></a>
  </h1>

  <div class="facts text-secondary">
    <dl><dt>Namespace</dt><dd><a class="xref" href="Ubiquity.html">Ubiquity</a>.<a class="xref" href="Ubiquity.NET.html">NET</a>.<a class="xref" href="Ubiquity.NET.Extensions.html">Extensions</a></dd></dl>
  <dl><dt>Assembly</dt><dd>Ubiquity.NET.Extensions.dll</dd></dl>
  </div>

  <div class="markdown summary"><p>Simple type to support direct creation of an immutable array via <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.collections.immutable.immutabledictionary-2">ImmutableDictionary&lt;TKey, TValue&gt;.Builder</a></p>
</div>
  <div class="markdown conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">[SuppressMessage(&quot;Design&quot;, &quot;CA1010:Generic interface should also be implemented&quot;, Justification = &quot;IEnumerable is unused but must exist to support collection initializers&quot;)]
[SuppressMessage(&quot;Naming&quot;, &quot;CA1710:Identifiers should have correct suffix&quot;, Justification = &quot;It is the correct suffix&quot;)]
[SuppressMessage(&quot;Performance&quot;, &quot;CA1815:Override equals and operator equals on value types&quot;, Justification = &quot;Equality not relevant for a builder&quot;)]
public readonly struct DictionaryBuilder&lt;TKey, TValue&gt; : IEnumerable where TKey : notnull</code></pre>
  </div>



  <h4 class="section">Type Parameters</h4>
  <dl class="parameters">
    <dt><code>TKey</code></dt>
    <dd><p>Type of the key</p>
</dd>
    <dt><code>TValue</code></dt>
    <dd><p>Type of the value</p>
</dd>
  </dl>


  <dl class="typelist implements">
    <dt>Implements</dt>
    <dd>
      <div><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.collections.ienumerable">IEnumerable</a></div>
    </dd>
  </dl>


  <dl class="typelist inheritedMembers">
    <dt>Inherited Members</dt>
    <dd>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.valuetype.equals">ValueType.Equals(object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.valuetype.gethashcode">ValueType.GetHashCode()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.valuetype.tostring">ValueType.ToString()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.equals#system-object-equals(system-object-system-object)">object.Equals(object, object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.gettype">object.GetType()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.referenceequals">object.ReferenceEquals(object, object)</a>
    </div>
  </dd></dl>

  <dl class="typelist extensionMethods">
    <dt>Extension Methods</dt>
    <dd>
  <div>
      <a class="xref" href="Ubiquity.NET.Extensions.FluentValidation.ExceptionValidationExtensions.ThrowIfNull.html#Ubiquity_NET_Extensions_FluentValidation_ExceptionValidationExtensions_ThrowIfNull__1___0_System_String_">ExceptionValidationExtensions.ThrowIfNull&lt;T&gt;(T?, string?)</a>
  </div>
  </dd></dl>



  <h2 id="Ubiquity_NET_Extensions_DictionaryBuilder_2_remarks">Remarks</h2>
  <div class="markdown level0 remarks"><p>
For unknown reasons <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.collections.immutable.immutabledictionary-2">ImmutableDictionary&lt;TKey, TValue&gt;</a> does not have an equivalent
to <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.runtime.compilerservices.collectionbuilderattribute">CollectionBuilderAttribute</a> (Perhaps because there is none for a dictionary?)
the normal behavior of initializing a mutable dictionary and then converting it to immutable
has sub-par performance as it needs to allocate the mutable form, add the members, then allocate
the immutable form and COPY all the members. This includes the overhead of building and maintaining
the hash codes for all the keys - just to copy it and destroy it... MUCH better performance is achieved
by building the dictionary directly then converting it into the final immutable form.
</p>
<p>This implementation is based on a post on StackOverflow by Ian Griffiths (updated for latest language
and runtime version functionality). It provides collection initialization support for
<a class="xref" href="https://learn.microsoft.com/dotnet/api/system.collections.immutable.immutabledictionary-2">ImmutableDictionary&lt;TKey, TValue&gt;</a>.</p>
</div>

  <h2 class="section" id="constructors">Constructors
</h2>

  <dl class="jumplist">
    <dt><a class="xref" href="Ubiquity.NET.Extensions.DictionaryBuilder-2.-ctor.html#Ubiquity_NET_Extensions_DictionaryBuilder_2__ctor">DictionaryBuilder()</a></dt>
    <dd><p>Simple type to support direct creation of an immutable array via <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.collections.immutable.immutabledictionary-2">ImmutableDictionary&lt;TKey, TValue&gt;.Builder</a></p>
</dd>
  </dl>

  <h2 class="section" id="properties">Properties
</h2>

  <dl class="jumplist">
    <dt><a class="xref" href="Ubiquity.NET.Extensions.DictionaryBuilder-2.Item.html#Ubiquity_NET_Extensions_DictionaryBuilder_2_Item__0_">this[TKey]</a></dt>
    <dd><p>Indexer to set the value of an entry</p>
</dd>
  </dl>

  <h2 class="section" id="methods">Methods
</h2>

  <dl class="jumplist">
    <dt><a class="xref" href="Ubiquity.NET.Extensions.DictionaryBuilder-2.Add.html#Ubiquity_NET_Extensions_DictionaryBuilder_2_Add__0__1_">Add(TKey, TValue)</a></dt>
    <dd><p>Add a key+value pair into the dictionary</p>
</dd>
  </dl>
  <dl class="jumplist">
    <dt><a class="xref" href="Ubiquity.NET.Extensions.DictionaryBuilder-2.GetEnumerator.html#Ubiquity_NET_Extensions_DictionaryBuilder_2_GetEnumerator">GetEnumerator()</a></dt>
    <dd><p>Returns an enumerator that iterates through a collection.</p>
</dd>
  </dl>
  <dl class="jumplist">
    <dt><a class="xref" href="Ubiquity.NET.Extensions.DictionaryBuilder-2.ToImmutable.html#Ubiquity_NET_Extensions_DictionaryBuilder_2_ToImmutable">ToImmutable()</a></dt>
    <dd><p>Creates an immutable dictionary based on the contents of this instance.</p>
</dd>
  </dl>


  <h2 id="seealso">See Also</h2>
  <div class="seealso">
      <div><span><a href="https://stackoverflow.com/questions/24033629/how-can-i-create-a-new-instance-of-immutabledictionary">https://stackoverflow.com/questions/24033629/how-can-i-create-a-new-instance-of-immutabledictionary</a></span></div>
  </div>

</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/UbiquityDotNET/Llvm.NET/blob/v20.1.8-rc.1/src/Ubiquity.NET.Extensions/DictionaryBuilder.cs/#L24" class="edit-link">Edit this page</a>
        </div>


      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>


    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          Copyright (C) 2017-2025, Ubiquity.NET Contributors
          - Build: 20.1.8-rc.1
        </div>
      </div>
    </footer>
  </body>
</html>
