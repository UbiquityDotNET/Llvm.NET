<Project Sdk="Microsoft.NET.Sdk">
    <PropertyGroup>
        <OutputType>Exe</OutputType>
        <AllowUnsafeBlocks>false</AllowUnsafeBlocks>
        <DebugType>portable</DebugType>
        <DebugSymbols>true</DebugSymbols>
        <SignAssembly>False</SignAssembly>
        <PlatformTarget>x64</PlatformTarget>
        <IsPublishable>False</IsPublishable>
        <TargetFramework>net8.0</TargetFramework>
        <!--Until C#14 and the "field" and "extension" keywords are available use the preview language -->
        <LangVersion>preview</LangVersion>
        <Nullable>enable</Nullable>
        <!--
        Targets matter as there are target/configuration specific headers generated by the LLVM libs build.
        Those headers can influence the Exports.def file as they will contain specifics of the configured
        targets (and not others). This sets a default for common IDE operations but it does REQUIRE that
        the most recent build of the LLVM libs matches the output.
        -->
        <LLvmTargets Condition="'$(LLvmTargets)'==''">X86;ARM</LLvmTargets>
        <!-- Don't build docs for public facing internal tool -->

        <GenerateDocumentationFile>False</GenerateDocumentationFile>
    </PropertyGroup>

    <ItemGroup>
        <PackageReference Include="CommandLineParser" PrivateAssets="all" />
        <PackageReference Include="CppSharp" PrivateAssets="all" />
        <PackageReference Include="System.CodeDom" PrivateAssets="all" />
    </ItemGroup>

    <!-- Runtime T4 templates need to specify the single file generator for the code behind -->
    <ItemGroup>
        <None Update="Templates\T4\ContextHandleTemplate.tt">
            <Generator>TextTemplatingFilePreprocessor</Generator>
            <LastGenOutput>ContextHandleTemplate.cs</LastGenOutput>
            <CustomToolNamespace>LlvmBindingsGenerator.Templates</CustomToolNamespace>
        </None>
        <None Update="Templates\T4\GlobalHandleTemplate.tt">
            <Generator>TextTemplatingFilePreprocessor</Generator>
            <LastGenOutput>GlobalHandleTemplate.cs</LastGenOutput>
            <CustomToolNamespace>LlvmBindingsGenerator.Templates</CustomToolNamespace>
        </None>
    </ItemGroup>

    <ItemGroup>
        <Compile Update="Templates\T4\ContextHandleTemplate.cs">
            <DesignTime>True</DesignTime>
            <AutoGen>True</AutoGen>
            <DependentUpon>ContextHandleTemplate.tt</DependentUpon>
        </Compile>
        <Compile Update="Templates\T4\GlobalHandleTemplate.cs">
            <DesignTime>True</DesignTime>
            <AutoGen>True</AutoGen>
            <DependentUpon>GlobalHandleTemplate.tt</DependentUpon>
        </Compile>
    </ItemGroup>

    <ItemGroup>
        <Service Include="{508349b6-6b84-4df5-91f0-309beebad82d}" />
    </ItemGroup>

</Project>
